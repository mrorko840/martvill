"use strict";var arraydata=[];function getmenus1(){getmenus(),updateitem(),actualizarmenu()}function getmenus(){arraydata=[],$("#spinsavemenu").show();var a=0;$("#menu-to-edit li").each(function(){for(var b,c=0,d=0;d<$("#menu-to-edit li").length;d++)b=$(this).attr("class").indexOf("menu-item-depth-"+d),-1!=b&&(c=d);var e=$(this).find(".item-edit").text(),f=this.id.split("-"),g=e.split("|"),h=0;!g[g.length-2]||g[g.length-2]==f[2]||(h=g[g.length-2]),arraydata.push({depth:c,id:f[2],parent:h,sort:a}),a++})}function addcustommenuToDb(){if("Label Name"==$("#custom-menu-item-name").val())return swal(jsLang("Please provide the label name to add menu item"),{icon:"error",buttons:[!1,jsLang("Ok")]}),!1;$("#spincustomu").show();var a=window.location.href,b=new URL(a);$.ajax({data:{labelmenu:$("#custom-menu-item-name").val(),linkmenu:$("#custom-menu-item-url").val(),customName:$(this).attr("data-name"),idmenu:b.searchParams.get("menu")},url:addCustomMenu,type:"POST",success:function(a){"info"==a.status?swal(a.message,{icon:"info",buttons:[!1,jsLang("Ok")]}):swal(jsLang("The menu has been successfully added."),{icon:"success",buttons:[!1,jsLang("Ok")]}).then(function(){window.location.reload()})},complete:function(){$("#spincustomu").hide()}})}function addcustommenu(){var a=[],b=[],c=[],d=[],e=[],f=jQuery(".menu:checked").length;if(0<f&&jQuery(".menu:checked").each(function(){a.push($(this).val()),b.push($(this).attr("data-name")),c.push($(this).attr("data-url")),d.push($(this).attr("data-permission")),e.push($(this).attr("data-delete"))}),jQuery.isEmptyObject(a))return swal(jsLang("Please select a menu to add"),{icon:"error",buttons:[!1,jsLang("Ok")]}),!1;$("#customMenuSpinner").show();var g=window.location.href,h=new URL(g),i=h.searchParams.get("menu");$.ajax({data:{labelmenu:$("#custom-menu-item-name").val(),linkmenu:$("#custom-menu-item-url").val(),rolemenu:$("#custom-menu-item-role").val(),customName:b,categoryUrl:c,permissionAttribute:d,isDeletable:e,idmenu:i,menuIds:a},url:addCustomMenu,type:"POST",success:function(a){"info"==a.status?swal(a.message,{icon:"info",buttons:[!1,jsLang("Ok")]}):swal(jsLang("The menu has been successfully added."),{icon:"success",buttons:[!1,jsLang("Ok")]}).then(function(){window.location.reload()})},complete:function(){$("#customMenuSpinner").hide()}})}function updateitem(a=0){if(a){var b=$("#idlabelmenu_"+a).val(),c=$("#clases_menu_"+a).val(),d=$("#url_menu_"+a).val(),e=$("#attribute_menu"+a).val(),f=0;$("#role_menu_"+a).length&&(f=$("#role_menu_"+a).val());var g={label:b,clases:c,url:d,role_id:f,params:e,id:a}}else{var h=[];$(".menu-item-settings").each(function(){var a=$(this).find(".edit-menu-item-id").val(),b=$(this).find(".edit-menu-item-title").val(),c=$(this).find(".edit-menu-item-attribute").val(),d=$(this).find(".edit-menu-item-classes").val(),e=$(this).find(".edit-menu-item-url").val(),f=$(this).find(".edit-menu-item-icon").val(),g=$(this).find(".edit-menu-item-role").val();h.push({id:a,label:b,class:d,link:e,icon:f,params:c,role_id:g})});var g={arraydata:h}}$.ajax({data:g,url:updateItem,type:"POST",beforeSend:function(){$("#hwpwrap .spinner .spincustomu2").css("display","inline")},success:function(a){"info"==a.status?swal(a.message,{icon:"info",buttons:[!1,jsLang("Ok")]}):swal(jsLang("The menu has been successfully updated."),{icon:"success",buttons:[!1,jsLang("Ok")]})},complete:function(){$("#hwpwrap .spinner .spincustomu2").css("display","none")}})}function actualizarmenu(){var a=window.location.href,b=new URL(a),c=b.searchParams.get("menu");$.ajax({dataType:"json",data:{arraydata:arraydata,menuname:$("#menu-name").val(),idmenu:c},url:generateMenuControl,type:"POST",beforeSend:function(){$(".spincustomu2").show()},success:function(a){2==a.resp&&swal(jsLang("The menu has been successfully updated."),{icon:"success",buttons:[!1,jsLang("Ok")]}).then(function(){window.location.reload()})},complete:function(){$(".spincustomu2").hide()}})}function deleteitem(a){swal({title:jsLang("Are you sure?"),icon:"warning",buttons:[jsLang("Cancel"),jsLang("Ok")],dangerMode:!0}).then(b=>{if(b){var c=window.location.href,d=new URL(c),e=d.searchParams.get("menu");$.ajax({dataType:"json",data:{id:a},url:deleteItemMenu,type:"POST",success:function(a){"info"==a.status&&swal(a.message,{icon:"info",buttons:[!1,jsLang("Ok")]}),1==a.error&&swal(jsLang("The menu has been successfully deleted."),{icon:"success",buttons:[!1,jsLang("Ok")]}).then(function(){window.location.reload()}),2==a.error&&swal(jsLang("You can not delete this menu"),{icon:"error",buttons:[!1,jsLang("Ok")]}).then(function(){window.location.reload()}),3==a.error&&swal(jsLang("Something went wrong, please try again."),{icon:"error",buttons:[!1,jsLang("Ok")]}).then(function(){window.location.reload()})}})}})}function deletemenu(){swal({title:jsLang("Are you sure?"),icon:"warning",buttons:[jsLang("Cancel"),jsLang("Ok")],dangerMode:!0}).then(a=>{if(a){var b=window.location.href,c=new URL(b),d=c.searchParams.get("menu");$.ajax({dataType:"json",data:{id:d},url:deleteMenu,type:"POST",beforeSend:function(){$(".spincustomu2").show()},success:function(a){"info"==a.status?swal(a.message,{icon:"info",buttons:[!1,jsLang("Ok")]}):a.error?3==a.error&&swal(jsLang("Something went wrong, please try again."),{icon:"error",buttons:[!1,jsLang("Ok")]}):swal(jsLang("The menu has been successfully deleted."),{icon:"success",buttons:[!1,jsLang("Ok")]}).then(function(){window.location.reload()})},complete:function(){$(".spincustomu2").hide()}})}})}function createnewmenu(){return!$("#menu-name").val()?(swal(jsLang("Enter name first"),{icon:"error",buttons:[!1,jsLang("Ok")]}),$("#menu-name").focus(),!1):void $.ajax({dataType:"json",data:{menuname:$("#menu-name").val()},url:createNewMenu,type:"POST",success:function(a){window.location=menuwr+"?menu="+a.resp}})}function insertParam(a,b){a=encodeURI(a),b=encodeURI(b);for(var c,d=document.location.search.substr(1).split("&"),e=d.length;e--;)if(c=d[e].split("="),c[0]==a){c[1]=b,d[e]=c.join("=");break}0>e&&(d[d.length]=[a,b].join("=")),document.location.search=d.join("&")}wpNavMenu.registerChange=function(){getmenus()},$(".item-edit").click(function(){$(this).closest("li").find(".icp-auto").iconpicker({placement:"inline"})}),$(document).on("click",".iconpicker-item",function(){$(".iconpicker-component").trigger("click")}),$(document).on("click",".menu-item-bar",function(){$("#edit-"+$(this).attr("id")).trigger("click"),$("#menu-item-"+$(this).attr("id")).hasClass("menu-item-edit-active")?$(this).closest("div").find(".iconpicker-popover").iconpicker({placement:"inline"}):$(this).closest("div").find(".iconpicker-popover").css("display","none").removeClass("in")});