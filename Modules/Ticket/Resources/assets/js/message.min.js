"use strict";const SITE_URL_ORIGIN=window.location.origin;$(".main-body .page-wrapper").find("#add-ticket-container").length&&$(document).ready(function(){$("#summernote").summernote({tabsize:2,height:120,blockquoteBreakingLevel:2,styleTags:["p",{title:"Blockquote",tag:"blockquote",className:"blockquote",value:"blockquote"},"pre","h1","h2","h3","h4","h5","h6"],toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link"]],["view",["fullscreen","codeview","help"]]],codeviewFilter:!0,codeviewFilterRegex:summernote_regex,callbacks:{onInit:function(){$("<div class=\"note-file btn-group note-btn-group\"><button id=\"makeSnote\" type=\"button\" class=\"note-btn editor-img-btn btn btn-default btn-sm has-media-manager\" data-val=\"single\" tabindex=\"-1\" title=\"\" aria-label=\"Picture\" data-original-title=\"Picture\" aria-describedby=\"tooltip682862\"><i class=\"note-icon-picture\"></i></button></div>").appendTo($(".note-toolbar")),$("#makeSnote").tooltip({container:"body",placement:"bottom"})},onChange:function(){}}}),$(document).on("change","#customer_id",function(){$("#assign_name").val($("option:selected",this).attr("data-name")),$("#assign_email").val($("option:selected",this).attr("data-email"))}),$(document).on("click","#add_ticket_btn",function(){return $("#summernote").summernote("isEmpty")?($("#ticket_messages-error").show().text("This field is required."),!1):($("#ticket_messages-error").hide(),!0)})}),$("#summernote").on("summernote.change",function(){$("#ticket_messages-error").hide()}),$(document).on("file-attached",".editor-img-btn",function(a,b){b.data.forEach(a=>{$("#summernote").summernote("pasteHTML"," <p><img src=\""+a.url+"\" style=\"width: 200px;\"/><br></p>")})}),$(document).on("file-attached",".has-thumbnail",function(a,b){$("#ticket-image").append(b.html)}),$(".main-body .page-wrapper").find("#reply-ticket-container").length&&($(document).ready(function(){$("#summernote").summernote({tabsize:2,height:120,blockquoteBreakingLevel:2,styleTags:["p",{title:"Blockquote",tag:"blockquote",className:"blockquote",value:"blockquote"},"pre","h1","h2","h3","h4","h5","h6"],toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link"]],["view",["codeview","help"]]],codeviewFilter:!0,codeviewFilterRegex:summernote_regex,callbacks:{onInit:function(){$("<div class=\"note-file btn-group note-btn-group\"><button id=\"makeSnote\" type=\"button\" class=\"note-btn editor-img-btn btn btn-default btn-sm has-media-manager\" data-val=\"single\" tabindex=\"-1\" title=\"\" aria-label=\"Picture\" data-original-title=\"Picture\" aria-describedby=\"tooltip682862\"><i class=\"note-icon-picture\"></i></button></div>").appendTo($(".note-toolbar"))},onChange:function(){}}})}),$(document).on("click","#add_ticket_btn",function(){return $("#summernote").summernote("isEmpty")?($("#ticket_messages-error").show().text("This field is required."),!1):($("#ticket_messages-error").hide(),!0)})),$(".main-body .page-wrapper").find("#edit-ticket-container").length&&$(document).ready(function(){$(function(){var a=$("#vendor_id option:selected").attr("data-name"),b=$("#vendor_id option:selected").attr("data-email");$("#assign_name").val(a),$("#assign_email").val(b)}),$(document).on("change","#vendor_id",function(){$("#assign_name").val($("option:selected",this).attr("data-name")),$("#assign_email").val($("option:selected",this).attr("data-email"))})}),$(document).on("click",".ticket_priority_change",function(){var a=$(this).attr("data-id"),b=$(this).attr("ticket_id"),c=$(this).attr("data-value");ticketPriorityChange(SITE_URL+"/ticket/priority-status",a,b,c)});function ticketPriorityChange(a,b,c,d){$.ajax({url:a,method:"get",data:{priorityId:b,ticketId:c,_token:token},dataType:"json",success:function(a){if(1==a.status){$("#removeLiPriority ul").empty(),$("#removeLiPriority ul").append(a.output),$(".priority-color").html(d);$(".priority-color").css("background-color",{Low:"#e1e0e0",Medium:"#fae39f",High:"#f2d2d2"}[$.trim(d)])}else{$(".noti-alert").append("<div class=\"alert alert-danger\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\">\xD7</button><strong>Something went wrong, please try again.</strong></div>"),$("#notifications").css("display","block")}}})}$(document).on("change","#assignee",function(){var a=$("#assignee").val()?$("#assignee").val():null,b=SITE_URL+"/ticket/change-assignee";$.ajax({url:b,method:"POST",data:{user_id:a,ticket_id:$("#ticketId").val(),_token:token},dataType:"json",beforeSend:function(){swal({title:jsLang("Loading..."),text:$("#assignee option:selected").text()+", "+jsLang("assigning to this ticket"),buttons:!1})},success:function(b){"1"==b.status?($("#assignee").val(a).trigger("change"),swal($("#assignee option:selected").text()+jsLang(" successfully assigned"),{icon:"success",buttons:[!1,jsLang("Ok")]})):"2"==b.status&&($("#assignee").val(a).trigger("change"),swal(jsLang(" please check your email configuration"),{icon:"error",buttons:[!1,jsLang("Ok")]}))}})}),$(document).on("click",".ticket_status_change",function(){var a=$(this).attr("data-id"),b=$(this).attr("ticket_id");ticketStatusChange(SITE_URL+"/ticket/change-status",a,b)}),$(document).on("click",".admin_ticket_status_change",function(){var a=$(this).attr("data-id"),b=$(this).attr("ticket_id");ticketStatusChange(SITE_URL+"/ticket/change-status",a,b)});function ticketStatusChange(a,b,c){$.ajax({url:a,method:"POST",data:{status_id:b,ticketId:c,_token:token},dataType:"json",success:function(a){1==a.status&&($("#status_label").html(a.newName),$("#status_label").css("color",a.newStatusColor),$("#ticket-status").html(a.newName),$("#ticket-status").removeClass("text-white").css("color",a.newStatusColor),$("#dataTableBuilder").length&&$("#dataTableBuilder").DataTable().ajax.reload())}})}$(document).on("click",".applyBtn, .ranges ul li:nth-child(1), .ranges ul li:nth-child(2), .ranges ul li:nth-child(3), .ranges ul li:nth-child(4), .ranges ul li:nth-child(5), .ranges ul li:nth-child(6), .ranges ul li:nth-child(7)",function(a){a.preventDefault();let b=$("#startfrom").val(),c=$("#endto").val();let d=$("#start_date"),e=$("#end_date");d.empty(),e.empty(),$.each({startFrom:b},function(a,b){d.append($("<option></option>").attr("value",b).text(a))}),$.each({endto:c},function(a,b){e.append($("<option></option>").attr("value",b).text(a))}),$("#start_date option:first").attr("selected","selected"),$("#end_date option:first").attr("selected","selected"),$("#start_date").trigger("change")}),$(document).on("keyup","#slug",function(){var a=this.value.replace(/[&\/\\#@,+()$~%.'":*?<>{}]/g,"");$("#slug").val(a.trim().toLowerCase().replace(/\s/g,"-"))}),$(".main-body .page-wrapper").find("#ticket-list-container").length&&($(document).ready(function(){$(document).on("click","#csv",function(a){a.preventDefault(),window.location=SITE_URL+"/ticket/csv?from="+$("#startfrom").val()+"&to="+$("#endto").val()+"&department_id="+$("#department_id").val()+"&status="+$("#status").val()+"&assignee="+$("#assignee").val()}),$(document).on("click","#pdf",function(a){a.preventDefault(),window.location=SITE_URL+"/ticket/pdf?from="+$("#startfrom").val()+"&to="+$("#endto").val()+"&department_id="+$("#department_id").val()+"&status="+$("#status").val()+"&assignee="+$("#assignee").val()}),$("#daterange-btn").daterangepicker(daterangeConfig(startDate,endDate),cbRange),cbRange(startDate,endDate)}),$("input[name=\"from\"]").daterangepicker(dateSingleConfig()),$("input[name=\"to\"]").daterangepicker(dateSingleConfig())),$(".edit-btn").on("click",function(){$(document).ready(function(){$("#summernote1").summernote({tabsize:2,height:120,blockquoteBreakingLevel:2,styleTags:["p",{title:"Blockquote",tag:"blockquote",className:"blockquote",value:"blockquote"},"pre","h1","h2","h3","h4","h5","h6"],toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link"]],["view",["codeview","help"]]],codeviewFilter:!0,codeviewFilterRegex:summernote_regex})}),$("#reply_id").val($(this).attr("data-id")),$("#update_type").val($(this).attr("data-message")),$("#summernote1").val($(this).attr("data-message"))}),$(".main-body .page-wrapper").find("#vendor-ticket-list-container").length&&($(document).ready(function(){$(document).on("click","#csv",function(a){a.preventDefault(),window.location=SITE_URL+"/ticket/csv?from="+$("#startfrom").val()+"&to="+$("#endto").val()+"&department_id="+$("#department_id").val()+"&status="+$("#status").val()}),$(document).on("click","#pdf",function(a){a.preventDefault(),window.location=SITE_URL+"/ticket/pdf?from="+$("#startfrom").val()+"&to="+$("#endto").val()+"&department_id="+$("#department_id").val()+"&status="+$("#status").val()}),$("#daterange-btn").daterangepicker(daterangeConfig(startDate,endDate),cbRange),cbRange(startDate,endDate)}),$("input[name=\"from\"]").daterangepicker(dateSingleConfig()),$("input[name=\"to\"]").daterangepicker(dateSingleConfig())),$(document).on("submit","#add_ticket_form,#reply_form,#replyModal",function(){$("#summernote").summernote("codeview.isActivated")&&$("#summernote").summernote("codeview.deactivate"),$("#summernote1").summernote("codeview.isActivated")&&$("#summernote1").summernote("codeview.deactivate")});
