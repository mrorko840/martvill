"use strict";if($(".main-body .page-wrapper").find("#order-checkout-container").length){function a(){$(".selected-tab").each(function(){$(this).hasClass("is-active")&&(tabName=$(this).attr("data-tab"),$("#selected_tab").val(tabName))}),"old"==tabName&&c()}function b(a){$.ajax({url:SITE_URL+"/order-get-shipping-tax",data:{address:a,_token:token},type:"POST",dataType:"JSON",beforeSend:function(){setTimeout(()=>{$(".checked-loader").block({message:`<div class="flex justify-center">
                    <svg class="animate-spin text-gray-700 w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="#000" stroke-width="3"></circle>
                    <path class="opacity-75" fill="#fff" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                    </div>`,css:{backgroundColor:"transparent",border:"none"}})},5)},success:function(a){1==a.status&&shippingTax(a.tax,a.shipping,a.totalPrice,a.shippingIndex,a.displayTaxTotal)},complete:function(){$(".checked-loader").unblock()}})}function c(){$(".address-form").hide(),$.each($(".required-field"),function(){$(this).prop("required",!1),$(this).removeAttr("oninvalid"),$(this).next("label").remove(),$(this).attr("readonly",!0)}),$.each($(".has-validation-error"),function(){$(this).removeClass("has-validation-error")})}function d(){$(".address-form").show(),$.each($(".required-field"),function(){$(this).prop("required",!0),$(this).attr("oninvalid","this.setCustomValidity(jsLang('This field is required.'))"),$(this).attr("readonly",!1)})}function e(a="tab_validation"){let b=`<option value="">${jsLang("Loading")}...</option>`;$.ajax({url:SITE_URL+"/geo-locale/countries",type:"GET",dataType:"json",beforeSend:function(){"tab_validation"==a?($("#country").html(b),$("#country").attr("disabled","true")):($("#shipping_address_country").html(b),$("#shipping_address_country").attr("disabled","true"))},success:function(b){"tab_validation"==a?$("#country").html("<option value=\"\">"+jsLang("Select Country")+"</option>"):$("#shipping_address_country").html("<option value=\"\">"+jsLang("Select Country")+"</option>"),$.each(b,function(b,c){"tab_validation"==a?($("#country").append(`'<option  ${c.code==oldCountry?"Selected":""} data-country="${c.code}" value="${c.code}">${c.name}</option>'`),$("#country").removeAttr("disabled")):($("#shipping_address_country").append(`'<option data-country="${c.code}" value="${c.code}">${c.name}</option>'`),$("#shipping_address_country").removeAttr("disabled"))})}})}function f(a="required"){"remove"==a?$.each($(".shipping_address_required-field"),function(){$(this).prop("required",!1),$(this).removeAttr("oninvalid"),$(this).next("label").remove(),$(this).attr("readonly",!0),$.each($(".validSelectShipping"),function(){$(this).removeClass("has-validation-error")})}):$.each($(".shipping_address_required-field"),function(){$(this).prop("required",!0),$(this).attr("oninvalid","this.setCustomValidity(jsLang('This field is required.'))"),$(this).attr("readonly",!1)})}function g(a){a?($("#shipping_address_state").html(""),"null"==oldCity&&$("#shipping_address_city").html(`<option value="">${jsLang("Select City")}</option>`),$.ajax({url:SITE_URL+"/geo-locale/countries/"+a+"/states",type:"GET",dataType:"json",beforeSend:function(){$("#shipping_address_state").attr("disabled","true"),$("#shipping_address_state").html(`<option value="">${jsLang("Loading")}...</option>`)},success:function(a){$("#shipping_address_state").html(`<option value="">${jsLang("Select State")}</option>`),$.each(a.data,function(a,b){$("#shipping_address_state").append(`'<option ${b.id==oldState?"Selected":""} data-state="${b.code}" value="${b.code}">${b.name}</option>'`)}),$("#shipping_address_state").removeAttr("disabled"),0>=a.length&&0>=a.data.length&&(errorMsg=errorMsg.replace(":x","State"),$("#shipping_address_state").html(`<option value="">${errorMsg}</option>`))}})):($("#shipping_address_state").html(`<option value="">${jsLang("Select State")}</option>`),$("#shipping_address_city").html(`<option value="">${jsLang("Select City")}</option>`))}function h(a,b){a&&b?($("#shipping_address_city").html(""),$.ajax({url:SITE_URL+"/geo-locale/countries/"+b+"/states/"+a+"/cities",type:"GET",dataType:"json",beforeSend:function(){$("#shipping_address_city").html(`<option value="">${jsLang("Loading")}...</option>`),$("#shipping_address_city").attr("disabled","true")},success:function(a){$("#shipping_address_city").html(`<option value="">${jsLang("Select City")}</option>`),$.each(a.data,function(a,b){$("#shipping_address_city").append(`<option ${b.name==oldCity?"Selected":""} value="${b.name}">${b.name}</option>`)}),$("#shipping_address_city").removeAttr("disabled"),0>=a.length&&0>=a.data.length&&(errorMsg=errorMsg.replace(":x","City"),$("#shipping_address_city").html(`<option value="">${errorMsg}</option>`))}})):$("#shipping_address_city").html(selectCity)}(function(){$(".address-radio").each(function(){if($(this).is(":checked")){let a=$(this).attr("data-addressId");$("#address_id").val(a),c()}})})();var tabName="old",defaultAddress=$("#defaultAddress").val();a(),$(document).on("keyup",".positive-int-number",function(){var a=$(this).val();$(this).val(a.replace(/[^0-9]/g,""))}),$("#default-address").on("change",function(){$(this).is(":checked")&&$.ajax({url:SITE_URL+"/user/check-default-address",data:{user_id:userId,_token:token},type:"POST",dataType:"JSON",success:function(a){const b=Swal.mixin({toast:!0,position:"bottom-start",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:a=>{a.addEventListener("mouseenter",Swal.stopTimer),a.addEventListener("mouseleave",Swal.resumeTimer)}});1==a.status?($("#new-address").prop("checked",!1),c()):(b.fire({icon:"error",title:jsLang("Default address not found! Please create a address & make it default")}),d(),$("#default-address").prop("checked",!1))}})}),$(document).on("change",".address-radio, #city, #zip",function(){let a={address_id:$(this).attr("data-addressId"),country:$("#country").val(),state:$("#state").val(),city:$("#city").val(),zip:$("#zip").val()};$("#ship_different").is(":checked")&&(a={address_id:$(this).attr("data-addressId"),country:$("#shipping_address_country").val(),state:$("#shipping_address_state").val(),city:$("#shipping_address_city").val(),zip:$("#shipping_address_zip").val(),billing_country:$("#country").val(),billing_state:$("#state").val(),billing_city:$("#city").val(),billing_zip:$("#zip").val(),ship_different:"on"}),b(a)}),$("#addressForm").on("submit",function(a){let b=!0;$(".type_of_place").is(":checked")||"old"==tabName?($("#errorMsg").removeClass("error"),$("#errorMsg").text("")):($("#errorMsg").addClass("error"),$("#errorMsg").text(jsLang("This field is required.")),a.preventDefault(),b=!1),"old"==tabName&&null==defaultAddress||"old"==tabName&&""==defaultAddress?(a.preventDefault(),$("#errorMsg_address").removeClass("display-none")):!0==b&&setTimeout(()=>{$("#makePayment").addClass("pointer-events-none"),$("#makePayment").html(`
                    <span>${jsLang("Make Payment")}</span><svg class="animate-spin text-gray-700 h-full ml-2 absolute" xmlns="http://www.w3.org/2000/svg" width="15" height="10" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="#000" stroke-width="3"></circle>
                        <path class="opacity-75" fill="#fff" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                         `)},5)}),$("#makePayment").on("click",function(){$(".type_of_place").is(":checked")?($("#errorMsg").removeClass("error"),$("#errorMsg").text("")):($("#errorMsg").addClass("error"),$("#errorMsg").text(jsLang("This field is required.")))}),$(".type_of_place").on("change",function(){$(this).is(":checked")&&($("#errorMsg").removeClass("error"),$("#errorMsg").text(""))}),$(".selected-tab").on("click",function(){$("#new-address"+defaultAddress).prop("checked",!1),$("#new-address-border"+defaultAddress).removeClass("border-gray-12"),$("#new-address-border"+defaultAddress).addClass("border-gray-2"),$(".s-icon").addClass("hidden"),tabName=$(this).attr("data-tab"),"old"==tabName?(c(),f("remove"),$("#ship_different").prop("checked",!1),$("#ship_different").trigger("change")):(d(),""!=$("#country").val()&&e(),defaultAddress=null),$("#selected_tab").val(tabName)}),$(".address-radio").click(function(){let a=$(this).closest("div.adress-container"),b=$(this).attr("data-addressId");defaultAddress=b,$("#address_id").val(b),c(),$("#errorMsg_address").addClass("display-none"),$(this).closest("div.adress-container").addClass("border-gray-12").removeClass("border-gray-2"),a.find(".s-icon").removeClass("hidden"),a.find(".ab-name, .ab-label").addClass("text-gray-12").removeClass("text-gray-10");let d=$(this).closest("div.c-tab"),e=d.children();for(let b,c=0;c<e.length;c++)b=$(e[c]),b[0]!==a[0]&&(b.removeClass("border-gray-12"),b.find(".s-icon").addClass("hidden"),b.find(".ab-name, .ab-label").removeClass("text-gray-12").addClass("text-gray-10"))});var m=new function(a){function b(){if(!g){g=!0;for(var a,b=0;b<j.length;b++)a=j[b],c(a,b);l&&e(j[m])}}function c(a,b){a.addEventListener("click",function(a){a.preventDefault(),d(b)})}function d(a){0<=a&&a!=m&&a<=j.length&&(j[m].classList.remove("is-active"),j[a].classList.add("is-active"),k[m].classList.remove("is-active"),k[a].classList.add("is-active"),l&&e(j[a]),m=a)}function e(a){l.style.left=a.offsetLeft+"px",l.style.width=a.offsetWidth+"px"}var f=document.querySelector(a.el),g=!1,h=f.querySelector(".c-tabs-nav"),j=f.querySelectorAll(".c-tabs-nav__link"),k=f.querySelectorAll(".c-tab"),l=!!a.marker&&function(){var a=document.createElement("div");return a.classList.add("c-tab-nav-marker"),h.appendChild(a),a}(),m=0;return{init:b,goToTab:d}}({el:"#tabs",marker:!0});m.init(),$(document).on("change","#ship_different",function(){let a={};$(this).is(":checked")?($("#different-address-form").removeClass("display-none"),$(".shippingAddressSelect").select2(),e("ship_different"),f(),a={address_id:$(this).attr("data-addressId"),country:$("#shipping_address_country").val(),state:$("#shipping_address_state").val(),city:$("#shipping_address_city").val(),zip:$("#shipping_address_zip").val(),billing_country:$("#country").val(),billing_state:$("#state").val(),billing_city:$("#city").val(),billing_zip:$("#zip").val(),ship_different:"on"}):($("#different-address-form").addClass("display-none"),f("remove"),a={address_id:$(this).attr("data-addressId"),country:$("#country").val(),state:$("#state").val(),city:$("#city").val(),zip:$("#zip").val()}),b(a)}),$("#shipping_address_country").on("change",function(){let a=$(this).find(":selected").html();if(0<a.length){let a=this.closest(".validSelectShipping");a.querySelector(".shippingAddressSelect").setCustomValidity(""),a.querySelector(".error")&&a.querySelector(".error").remove()}g($("#shipping_address_country").find(":selected").attr("data-country"))}),$("#shipping_address_state").on("change",function(){let a=$(this).find(":selected").html();if(0<a.length){let a=this.closest(".validSelectShipping");a.querySelector(".shippingAddressSelect").setCustomValidity(""),a.querySelector(".error")&&a.querySelector(".error").remove()}h($("#shipping_address_state").find(":selected").attr("data-state"),$("#shipping_address_country").find(":selected").attr("data-country"))}),$("#shipping_address_city").on("change",function(){let a=$(this).find(":selected").html();if(0<a.length){let a=this.closest(".validSelectShipping");a.querySelector(".shippingAddressSelect").setCustomValidity(""),a.querySelector(".error")&&a.querySelector(".error").remove();let c={address_id:$(this).attr("data-addressId"),country:$("#shipping_address_country").val(),state:$("#shipping_address_state").val(),city:$("#shipping_address_city").val(),zip:$("#shipping_address_zip").val(),billing_country:$("#country").val(),billing_state:$("#state").val(),billing_city:$("#city").val(),billing_zip:$("#zip").val(),ship_different:"on"};b(c)}}),$("#shipping_address_zip").on("change",function(){let a={address_id:$(this).attr("data-addressId"),country:$("#shipping_address_country").val(),state:$("#shipping_address_state").val(),city:$("#shipping_address_city").val(),zip:$("#shipping_address_zip").val(),billing_country:$("#country").val(),billing_state:$("#state").val(),billing_city:$("#city").val(),billing_zip:$("#zip").val(),ship_different:"on"};b(a)})}
